name: Remote PowerShell Session (PS Classic)

references:
  public:
    1: https://threathunterplaybook.com/hunts/windows/190511-RemotePwshExecution/notebook.html
  #internal:
    #a: 

metadata:
  uuid: 60167e5c-84b2-4c95-a7ac-86281f27c445
  schema: mdr::2.1
  version: 1
  created: 2019-08-10
  modified: 2019-08-10
  tlp: amber+strict
  author: Roberto Rodriguez @Cyb3rWard0g
  #contributors:
    #-
  #organisation:
    #uuid: 
    #name: 

description: |
  Detects remote PowerShell sessions

#detection_model: 

response:
  alert_severity: Low
  #playbook: https://
  #responders: 

configurations:
  splunk:
    schema: splunk::2.1
    status: DEVELOPMENT
    #contributors:
      #-
    #tenants:
      #-
    #flags:
      #-

    #scheduling:
      #cron: # MANUAL COMPLETION REQUIRED
      #frequency: # MANUAL COMPLETION REQUIRED
      #custom_time: # MANUAL COMPLETION REQUIRED
      #lookback: # MANUAL COMPLETION REQUIRED

    #threshold: 0

    #throttling:
      #fields:
        #-
      #duration: 1h

    #notable:
      #event:
        #title: 
        #description: |
          #...
      #drilldown:
        #name: 
        #search: |
          #...
      #security_domain: 

    #risk:
      #message: 
      #risk_objects:
        #- field: 
          #type: 
          #score: 
      #threat_objects:
        #- field: 
          #type: 

    query: |
      index=* search Data="*HostName=ServerRemoteHost*" Data="*wsmprovhost.exe*"